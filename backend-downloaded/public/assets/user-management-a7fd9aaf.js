import{b as ve,aN as fe,f as se,d as Ee,r as l,bF as Me,bT as be,O,N as B,j as e,D as q,aJ as ce,bc as te,aK as de,aE as ae,aq as ye,ar as Ce,as as we,at as Se,au as Pe,aA as le,az as f,bM as Te,bN as ke,av as Ie,bO as Ne,bP as Le,ao as P,B as b,m as ne,w as T,aH as ue,aI as he,bA as xe,bU as N,bV as G,bW as V,bX as Y,M as U,bY as pe,S as z,bZ as oe,bb as me,I as Fe,b_ as ds,b$ as us,c0 as hs,c1 as xs,_ as je,T as F,c2 as ps,c3 as ms,c4 as gs,aC as js,c5 as vs,c6 as fs,V as bs,ba as ys,Q as Cs,X as ws,G as Ue,W as Ss}from"./index-b5422eae.js";import{d as Ps,u as Ts,c as ks,g as Ye}from"./user-4a45e0ac.js";import{D as He}from"./DateTimePicker-537bd9ba.js";import{C as Is}from"./CardContent-4a131abb.js";const qe=[{id:"name",label:"Name"},{id:"username",label:"Username",width:180},{id:"email",label:"Email",width:220},{id:"userType",label:"User Type",width:180},{id:"status",label:"Status",width:100},{id:"",width:88}],Ns={1:"Admin",2:"User",3:"Service Technician",4:"Guest"},_e={name:"",status:"all",role:[]},Fs=[{value:"1",label:"Admin"},{value:"2",label:"User"},{value:"3",label:"Service Technician"},{value:"4",label:"Guest"}];function Us({inputData:t,comparator:s,filters:a}){const{name:i,status:d,role:u}=a,n=t.map((r,x)=>[r,x]);return n.sort((r,x)=>{const p=s(r[0],x[0]);return p!==0?p:r[1]-x[1]}),t=n.map(r=>r[0]),i&&(t=t.filter(r=>r.name.toLowerCase().indexOf(i.toLowerCase())!==-1||r.username.toLowerCase().indexOf(i.toLowerCase())!==-1||r.email.toLowerCase().indexOf(i.toLowerCase())!==-1)),d!=="all"&&(t=t.filter(r=>r.status===d)),u.length&&(t=t.filter(r=>u.includes(String(r.userTypeId)))),t}function _s(){const t=ve(),s=fe(),a=se(),i=se(),{enqueueSnackbar:d}=Ee(),[u,n]=l.useState([]),[r,x]=l.useState(_e),[p,S]=l.useState(null),[_,m]=l.useState(!1),j=Us({inputData:u,comparator:Me(s.order,s.orderBy),filters:r}),I=j.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),E=s.dense?52:72,$=!be(_e,r),A=!j.length&&$||!j.length,w=l.useCallback(async()=>{try{m(!0);const D=((await O.get(B.user.list)).response||[]).map(k=>{const{password:Z,...h}=k;return{...h,name:`${k.first_name} ${k.last_name}`,username:k.user_name,userType:Ns[k.user_type]||"Unknown",userTypeId:k.user_type,status:k.status===1?"active":"inactive"}});n(D)}catch(o){console.error("Error loading users:",o),n([])}finally{m(!1)}},[]);l.useEffect(()=>{w()},[w]);const X=l.useCallback((o,C)=>{s.onResetPage(),x(D=>({...D,[o]:C}))},[s]),R=l.useCallback((o,C)=>{X("status",C)},[X]),M=l.useCallback(async o=>{try{await Ps(o),await w(),s.onUpdatePageDeleteRow(I.length),d("User deleted successfully",{variant:"success"})}catch(C){console.error("Error deleting user:",C),d("Failed to delete user",{variant:"error"})}},[I.length,s,w,d]),L=l.useCallback(o=>{S(o),i.onTrue()},[i]),J=l.useCallback(async o=>{try{const C={user_name:o.username,email:o.email,password:o.password,user_type:parseInt(o.userType,10),status:o.status==="active"?1:0,first_name:o.firstName||"User",last_name:o.lastName||"Name",mobile:o.mobile||""};p?(await Ts(p.id,C),d("User updated successfully",{variant:"success"})):(await ks(C),d("User created successfully",{variant:"success"})),await w(),i.onFalse(),S(null)}catch(C){console.error("Error saving user:",C),d("Failed to save user",{variant:"error"})}},[p,w,i,d]),Q=l.useCallback(()=>{S(null),i.onTrue()},[i]);window.openNewUserDialog=Q;const re=l.useCallback(()=>{x(_e)},[]),H=o=>u.filter(C=>C.status===o).length,K=[{value:"all",label:"All",color:"default",count:u.length},{value:"active",label:"Active",color:"success",count:H("active")},{value:"inactive",label:"Inactive",color:"default",count:H("inactive")}];return e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(ce,{value:r.status,onChange:R,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${te(t.palette.grey[500],.08)}`,backgroundColor:t.palette.primary.main},children:K.map(o=>e.jsx(de,{value:o.value,label:o.label,iconPosition:"end",icon:e.jsx(ae,{variant:(o.value==="all"||o.value===r.status)&&"filled"||"soft",color:o.color,children:o.count}),sx:{color:r.status===o.value?t.palette.primary.contrastText:"white","&.Mui-selected":{color:t.palette.primary.contrastText},"&:hover":{backgroundColor:te(t.palette.grey[500],.1)}}},o.value))}),e.jsx(Rs,{filters:r,onFilters:X,roleOptions:Fs}),$&&e.jsx(Es,{filters:r,onFilters:X,onResetFilters:re,results:j.length,sx:{p:2.5,pt:0}}),e.jsx(ye,{sx:{position:"relative",overflow:"unset"},children:e.jsx(Ce,{children:e.jsxs(we,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Se,{order:s.order,orderBy:s.orderBy,headLabel:qe,rowCount:u.length,onSort:s.onSort}),e.jsxs(Pe,{children:[_&&e.jsx(le,{children:e.jsx(f,{colSpan:qe.length,align:"center",sx:{py:3},children:"Loading users..."})}),!_&&j.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(o=>e.jsx(As,{row:o,onDeleteRow:()=>M(o.id),onEditRow:()=>L(o)},o.id)),e.jsx(Te,{height:E,emptyRows:ke(s.page,s.rowsPerPage,u.length)}),e.jsx(Ie,{notFound:A})]})]})})}),e.jsx(Ne,{count:j.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,dense:s.dense,onChangeDense:s.onChangeDense})]}),e.jsx(Ds,{open:i.value,onClose:i.onFalse,user:p,onSave:J}),e.jsx(Le,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure you want to delete this user?",action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{a.onFalse()},children:"Delete"})})]})}function As({row:t,onDeleteRow:s,onEditRow:a}){const i=t.user_type===2||t.user_type==="2";return e.jsxs(le,{hover:!0,children:[e.jsx(f,{children:t.name}),e.jsx(f,{children:t.username}),e.jsx(f,{children:t.email}),e.jsx(f,{children:t.userType}),e.jsx(f,{children:e.jsx(ae,{variant:"soft",color:t.status==="active"&&"success"||"default",children:t.status})}),e.jsx(f,{align:"right",children:e.jsxs(b,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[e.jsx(ne,{onClick:a,size:"small",children:e.jsx(T,{icon:"solar:pen-bold"})}),i&&e.jsx(ne,{onClick:s,size:"small",sx:{color:"error.main"},children:e.jsx(T,{icon:"solar:trash-bin-trash-bold"})})]})})]})}function Ds({open:t,onClose:s,user:a,onSave:i}){const[d,u]=l.useState({username:"",email:"",password:"",userType:"1",status:"active",firstName:"",lastName:"",mobile:""});l.useEffect(()=>{u(a?{username:a.username||a.user_name||"",email:a.email||"",password:"",userType:String(a.userTypeId||a.user_type||"1"),status:a.status||"active",firstName:a.first_name||"",lastName:a.last_name||"",mobile:a.mobile||""}:{username:"",email:"",password:"",userType:"2",status:"active",firstName:"",lastName:"",mobile:""})},[a]);const n=x=>p=>{u(S=>({...S,[x]:p.target.value}))},r=()=>{i(d)};return e.jsxs(ue,{open:t,onClose:s,maxWidth:"sm",fullWidth:!0,children:[e.jsx(he,{children:a?"Edit User":"New User"}),e.jsx(xe,{children:e.jsxs(b,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[e.jsxs(b,{sx:{display:"flex",gap:2},children:[e.jsx(N,{label:"First Name",value:d.firstName,onChange:n("firstName"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Last Name",value:d.lastName,onChange:n("lastName"),fullWidth:!0,required:!0})]}),e.jsx(N,{label:"Username",value:d.username,onChange:n("username"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Email",type:"email",value:d.email,onChange:n("email"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Mobile",value:d.mobile,onChange:n("mobile"),fullWidth:!0}),e.jsx(N,{label:"Password",type:"password",value:d.password,onChange:n("password"),fullWidth:!0,required:!a,helperText:a?"Leave empty to keep current password":""}),e.jsxs(G,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs(Y,{value:d.status,onChange:n("status"),label:"Status",children:[e.jsx(U,{value:"active",children:"Active"}),e.jsx(U,{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs(pe,{children:[e.jsx(P,{onClick:s,children:"Cancel"}),e.jsx(P,{onClick:r,variant:"contained",color:"primary",children:"Save"})]})]})}function Rs({filters:t,onFilters:s,roleOptions:a}){const i=l.useCallback(u=>{s("name",u.target.value)},[s]),d=l.useCallback(u=>{s("role",typeof u.target.value=="string"?u.target.value.split(","):u.target.value)},[s]);return e.jsxs(z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsxs(G,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[e.jsx(V,{children:"Role"}),e.jsx(Y,{multiple:!0,value:t.role,onChange:d,input:e.jsx(oe,{label:"Role"}),renderValue:u=>u.length===0?"All Roles":a.filter(n=>u.includes(n.value)).map(n=>n.label).join(", "),sx:{textTransform:"capitalize"},children:a.map(u=>e.jsxs(U,{value:u.value,children:[e.jsx(me,{disableRipple:!0,color:"default",size:"small",checked:t.role.includes(u.value)}),u.label]},u.value))})]}),e.jsx(z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:e.jsx(N,{fullWidth:!0,value:t.name,onChange:i,placeholder:"Search by name, username or email...",InputProps:{startAdornment:e.jsx(Fe,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]})}function Es({filters:t,onFilters:s,onResetFilters:a,results:i,sx:d}){return e.jsxs(b,{sx:{...d,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("strong",{children:i}),e.jsx(b,{component:"span",sx:{color:"text.secondary"},children:"results found"})]}),e.jsx(P,{color:"error",onClick:a,startIcon:e.jsx(T,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})}const Ms=async()=>await O.get(B.department.list),Ls=async t=>await O.post(B.department.insert,t),Ws=async(t,s)=>await O.put(B.department.update(t),s),zs=async t=>await O.delete(B.department.delete(t)),Os=async t=>await O.get(B.departmentModule.getDepartmentModules(t)),Bs=async(t,s)=>await O.post(B.departmentModule.updateDepartmentModules(t),{module_permissions:s}),Ge=[{id:"name",label:"Department Name",width:180},{id:"code",label:"Code",width:120},{id:"description",label:"Description",width:250},{id:"status",label:"Status",width:100},{id:"users",label:"Users",width:100},{id:"modules",label:"Modules",width:100},{id:"",width:120}],Ae={name:"",status:"all"};function $s(){const t=ve(),s=fe(),a=se(),i=se(),d=se(),u=se(),{enqueueSnackbar:n}=Ee(),[r,x]=l.useState([]),[p,S]=l.useState([]),[_,m]=l.useState([]),[j,I]=l.useState(Ae),[E,$]=l.useState(!1),[A,w]=l.useState(null),[X,R]=l.useState([]),[M,L]=l.useState([]),[J,Q]=l.useState([]),[re,H]=l.useState([]),[K,o]=l.useState([]),[C,D]=l.useState([]),k=Js({inputData:r,comparator:Me(s.order,s.orderBy),filters:j}),Z=k.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),h=s.dense?52:72,v=!be(Ae,j),W=!k.length&&v||!k.length,ie=l.useCallback(async()=>{try{$(!0);const c=await Ms();if(c.status&&c.response){const g=c.response.map(y=>({...y,status:y.status===1?"active":"inactive"}));x(g)}}catch(c){console.error("Error loading departments:",c),x([])}finally{$(!1)}},[]),We=l.useCallback(async()=>{try{const c=await Ye();if(c.status&&c.response){const g=c.response.map(y=>({...y,name:`${y.first_name} ${y.last_name}`}));S(g)}}catch(c){console.error("Error loading users:",c),S([])}},[]),ze=l.useCallback(async()=>{try{const c=await ds();console.log("Modules response:",c),c&&c.response?m(c.response):c&&Array.isArray(c)&&m(c)}catch(c){console.error("Error loading modules:",c),m([])}},[]);l.useEffect(()=>{ie(),We(),ze()},[ie,We,ze]);const ge=l.useCallback((c,g)=>{s.onResetPage(),I(y=>({...y,[c]:g}))},[s]),Ke=l.useCallback(async c=>{try{await zs(c),await ie(),s.onUpdatePageDeleteRow(Z.length),n("Department deleted successfully",{variant:"success"})}catch(g){console.error("Error deleting department:",g),n("Failed to delete department",{variant:"error"})}},[Z.length,s,ie]),Qe=l.useCallback(c=>{w(c),i.onTrue()},[i]),Ze=l.useCallback(async c=>{try{const g={department_name:c.name,department_code:c.code,description:c.description,status:c.status==="active"?1:0};A?(await Ws(A.id,g),n("Department updated successfully",{variant:"success"})):(await Ls(g),n("Department created successfully",{variant:"success"})),await ie(),i.onFalse(),w(null)}catch(g){console.error("Error saving department:",g),n("Failed to save department",{variant:"error"})}},[A,ie,i]),es=l.useCallback(()=>{w(null),i.onTrue()},[i]);window.openNewDepartmentDialog=es;const ss=l.useCallback(()=>{I(Ae)},[]),ts=l.useCallback(async c=>{try{const g=await us(c.id),y=g.data||g.response||[];R(y),L(y.map(ee=>ee.user_id||ee.id)),Q(y.map(ee=>ee.user_id||ee.id)),w(c),d.onTrue()}catch(g){console.error("Error loading department users:",g)}},[d]),as=l.useCallback(c=>{L(g=>g.includes(c)?g.filter(y=>y!==c):[...g,c])},[]),ns=l.useCallback(async()=>{try{const c=M.filter(y=>!J.includes(y)),g=J.filter(y=>!M.includes(y));for(const y of c)await hs(y,A.id);for(const y of g)await xs(y,A.id);d.onFalse(),w(null),L([]),Q([]),n("User assignments updated successfully",{variant:"success"})}catch(c){console.error("Error saving user assignments:",c),n("Failed to update user assignments",{variant:"error"})}},[M,J,A,d,n]),ls=l.useCallback(async c=>{try{const g=await Os(c.id),y=g.data||g.response||[],ee=y.map(Be=>{var $e;return Be.module_id||(($e=Be.Module)==null?void 0:$e.id)});H(y),o(ee),D(ee),w(c),u.onTrue()}catch(g){console.error("Error loading department modules:",g),n("Failed to load department modules",{variant:"error"})}},[u,n]),rs=l.useCallback(c=>{o(g=>g.includes(c)?g.filter(y=>y!==c):[...g,c])},[]),is=l.useCallback(async()=>{try{const c=K.map(g=>({module_id:g,can_view:!0,can_add_edit:!1,can_delete:!1}));await Bs(A.id,c),u.onFalse(),w(null),o([]),D([]),n("Module assignments updated successfully",{variant:"success"})}catch(c){console.error("Error saving module assignments:",c),n("Failed to update module assignments",{variant:"error"})}},[K,A,u,n]),Oe=c=>r.filter(g=>g.status===c).length,os=[{value:"all",label:"All",color:"default",count:r.length},{value:"active",label:"Active",color:"success",count:Oe("active")},{value:"inactive",label:"Inactive",color:"default",count:Oe("inactive")}],cs=l.useCallback((c,g)=>{ge("status",g)},[ge]);return e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(ce,{value:j.status,onChange:cs,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${te(t.palette.grey[500],.08)}`,backgroundColor:t.palette.primary.main},children:os.map(c=>e.jsx(de,{value:c.value,label:c.label,iconPosition:"end",icon:e.jsx(ae,{variant:(c.value==="all"||c.value===j.status)&&"filled"||"soft",color:c.color,children:c.count}),sx:{color:j.status===c.value?t.palette.primary.contrastText:"white","&.Mui-selected":{color:t.palette.primary.contrastText},"&:hover":{backgroundColor:te(t.palette.grey[500],.1)}}},c.value))}),e.jsx(Ks,{filters:j,onFilters:ge}),v&&e.jsx(Qs,{filters:j,onFilters:ge,onResetFilters:ss,results:k.length,sx:{p:2.5,pt:0}})]}),e.jsxs(q,{children:[e.jsx(ye,{sx:{position:"relative",overflow:"unset"},children:e.jsx(Ce,{children:e.jsxs(we,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Se,{order:s.order,orderBy:s.orderBy,headLabel:Ge,rowCount:r.length,onSort:s.onSort}),e.jsxs(Pe,{children:[E&&e.jsx(le,{children:e.jsx(f,{colSpan:Ge.length,align:"center",sx:{py:3},children:"Loading departments..."})}),!E&&k.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(c=>e.jsx(Hs,{row:c,onDeleteRow:()=>Ke(c.id),onEditRow:()=>Qe(c),onManageUsers:()=>ts(c),onManageModules:()=>ls(c)},c.id)),e.jsx(Te,{height:h,emptyRows:ke(s.page,s.rowsPerPage,r.length)}),e.jsx(Ie,{notFound:W})]})]})})}),e.jsx(Ne,{count:k.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,dense:s.dense,onChangeDense:s.onChangeDense})]}),e.jsx(qs,{open:i.value,onClose:i.onFalse,department:A,onSave:Ze}),e.jsx(Gs,{open:d.value,onClose:d.onFalse,department:A,users:p,selectedUsers:M,onUserToggle:as,onSave:ns}),e.jsx(Xs,{open:u.value,onClose:u.onFalse,department:A,modules:_,selectedModules:K,onModuleToggle:rs,onSave:is}),e.jsx(Le,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure you want to delete the selected department?",action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{a.onFalse()},children:"Delete"})})]})}function Hs({row:t,onDeleteRow:s,onEditRow:a,onManageUsers:i,onManageModules:d}){return e.jsxs(le,{hover:!0,children:[e.jsx(f,{children:t.department_name}),e.jsx(f,{children:e.jsx(je,{label:t.department_code,size:"small",variant:"outlined",color:"primary"})}),e.jsx(f,{children:t.description||"No description"}),e.jsx(f,{children:e.jsx(ae,{variant:"soft",color:t.status==="active"&&"success"||"default",children:t.status})}),e.jsx(f,{children:e.jsx(P,{variant:"outlined",size:"small",onClick:i,startIcon:e.jsx(T,{icon:"mingcute:user-3-line"}),children:"Users"})}),e.jsx(f,{children:e.jsx(P,{variant:"outlined",size:"small",onClick:d,startIcon:e.jsx(T,{icon:"mingcute:apps-line"}),children:"Modules"})}),e.jsx(f,{align:"right",children:e.jsxs(b,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[e.jsx(ne,{onClick:a,size:"small",children:e.jsx(T,{icon:"solar:pen-bold"})}),e.jsx(ne,{onClick:s,size:"small",sx:{color:"error.main"},children:e.jsx(T,{icon:"solar:trash-bin-trash-bold"})})]})})]})}function qs({open:t,onClose:s,department:a,onSave:i}){const[d,u]=l.useState({name:"",code:"",description:"",status:"active"});l.useEffect(()=>{u(a?{name:a.department_name||"",code:a.department_code||"",description:a.description||"",status:a.status||"active"}:{name:"",code:"",description:"",status:"active"})},[a]);const n=x=>p=>{u(S=>({...S,[x]:p.target.value}))},r=()=>{i(d)};return e.jsxs(ue,{open:t,onClose:s,maxWidth:"sm",fullWidth:!0,children:[e.jsx(he,{children:a?"Edit Department":"New Department"}),e.jsx(xe,{children:e.jsxs(b,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[e.jsx(N,{label:"Department Name",value:d.name,onChange:n("name"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Department Code",value:d.code,onChange:n("code"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Description",value:d.description,onChange:n("description"),fullWidth:!0,multiline:!0,rows:3}),e.jsxs(G,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs(Y,{value:d.status,onChange:n("status"),label:"Status",children:[e.jsx(U,{value:"active",children:"Active"}),e.jsx(U,{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs(pe,{children:[e.jsx(P,{onClick:s,children:"Cancel"}),e.jsx(P,{onClick:r,variant:"contained",color:"primary",children:"Save"})]})]})}function Gs({open:t,onClose:s,department:a,users:i,selectedUsers:d,onUserToggle:u,onSave:n}){const r=ve(),x=fe(),[p,S]=l.useState({name:"",status:"all",role:[]}),[_,m]=l.useState("all"),j=o=>o.first_name&&o.last_name?`${o.first_name} ${o.last_name}`:o.user_name,I=o=>({1:"Admin",2:"User",3:"Service Technician",4:"Guest"})[o]||"Unknown",E=[{value:"1",label:"Admin"},{value:"2",label:"User"},{value:"3",label:"Service Technician"},{value:"4",label:"Guest"}],$=[{id:"select",label:"",width:60},{id:"name",label:"Name"},{id:"username",label:"Username",width:180},{id:"email",label:"Email",width:220},{id:"userType",label:"User Type",width:180},{id:"status",label:"Status",width:100}],w=(({inputData:o,filters:C})=>{const{name:D,status:k,role:Z}=C;let h=[...o];return D&&(h=h.filter(v=>j(v).toLowerCase().includes(D.toLowerCase())||v.user_name.toLowerCase().includes(D.toLowerCase())||v.email.toLowerCase().includes(D.toLowerCase()))),k!=="all"&&(h=h.filter(v=>(v.status===1?"active":"inactive")===k)),Z.length&&(h=h.filter(v=>Z.includes(String(v.user_type)))),h})({inputData:i,filters:p}),X=w.slice(x.page*x.rowsPerPage,x.page*x.rowsPerPage+x.rowsPerPage),R=l.useCallback((o,C)=>{x.onResetPage(),S(D=>({...D,[o]:C}))},[x]),M={name:"",status:"all",role:[]},L=!be(M,p),J=!w.length&&L||!w.length,Q=l.useCallback(()=>{S(M)},[]),re=l.useCallback((o,C)=>{m(C),R("status",C)},[R]),H=o=>o==="all"?i.length:i.filter(C=>(C.status===1?"active":"inactive")===o).length,K=[{value:"all",label:"All",color:"default",count:H("all")},{value:"active",label:"Active",color:"success",count:H("active")},{value:"inactive",label:"Inactive",color:"default",count:H("inactive")}];return e.jsxs(ue,{open:t,onClose:s,maxWidth:"lg",fullWidth:!0,children:[e.jsx(he,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(F,{variant:"h6",children:["Manage Users - ",a==null?void 0:a.department_name]}),e.jsx(ne,{onClick:s,size:"small",children:e.jsx(T,{icon:"mingcute:close-line"})})]})}),e.jsxs(xe,{children:[e.jsxs(b,{sx:{mb:2},children:[e.jsx(F,{variant:"subtitle1",gutterBottom:!0,children:"Assign users to this department"}),e.jsx(F,{variant:"body2",color:"text.secondary",children:"Check the users you want to assign to this department"})]}),e.jsxs(q,{children:[e.jsx(ce,{value:_,onChange:re,sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${te(r.palette.grey[500],.08)}`,backgroundColor:r.palette.primary.main},children:K.map(o=>e.jsx(de,{value:o.value,label:o.label,iconPosition:"end",icon:e.jsx(ae,{variant:(o.value==="all"||o.value===_)&&"filled"||"soft",color:o.color,children:o.count}),sx:{color:_===o.value?r.palette.primary.contrastText:"white","&.Mui-selected":{color:r.palette.primary.contrastText},"&:hover":{backgroundColor:te(r.palette.grey[500],.1)}}},o.value))}),e.jsx(Vs,{filters:p,onFilters:R,roleOptions:E}),L&&e.jsx(Ys,{filters:p,onFilters:R,onResetFilters:Q,results:w.length,sx:{p:2.5,pt:0}}),e.jsx(ye,{sx:{position:"relative",overflow:"unset"},children:e.jsx(Ce,{children:e.jsxs(we,{size:x.dense?"small":"medium",sx:{minWidth:800},children:[e.jsx(Se,{order:x.order,orderBy:x.orderBy,headLabel:$,rowCount:w.length,onSort:x.onSort}),e.jsxs(Pe,{children:[X.filter(o=>o.id!==1).map(o=>e.jsxs(le,{hover:!0,children:[e.jsx(f,{padding:"checkbox",children:e.jsx(me,{checked:d.includes(o.id),onChange:()=>u(o.id)})}),e.jsx(f,{children:j(o)}),e.jsx(f,{children:o.user_name}),e.jsx(f,{children:o.email}),e.jsx(f,{children:I(o.user_type)}),e.jsx(f,{children:e.jsx(ae,{variant:"soft",color:o.status===1&&"success"||"default",children:o.status===1?"Active":"Inactive"})})]},o.id)),e.jsx(Te,{height:x.dense?52:72,emptyRows:ke(x.page,x.rowsPerPage,w.length)}),e.jsx(Ie,{notFound:J})]})]})})}),e.jsx(Ne,{count:w.length,page:x.page,rowsPerPage:x.rowsPerPage,onPageChange:x.onChangePage,onRowsPerPageChange:x.onChangeRowsPerPage,dense:x.dense,onChangeDense:x.onChangeDense})]})]}),e.jsxs(pe,{children:[e.jsx(P,{onClick:s,children:"Cancel"}),e.jsx(P,{onClick:n,variant:"contained",color:"primary",children:"Save"})]})]})}function Vs({filters:t,onFilters:s,roleOptions:a}){const i=l.useCallback(n=>{s("name",n.target.value)},[s]),d=l.useCallback(n=>{s("role",typeof n.target.value=="string"?n.target.value.split(","):n.target.value)},[s]),u=l.useCallback(n=>{s("status",n.target.value)},[s]);return e.jsxs(z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsxs(G,{sx:{flexShrink:0,width:{xs:1,md:140}},children:[e.jsx(V,{children:"Status"}),e.jsxs(Y,{value:t.status,onChange:u,input:e.jsx(oe,{label:"Status"}),MenuProps:{PaperProps:{sx:{maxHeight:240}}},children:[e.jsx(U,{value:"all",children:"All"}),e.jsx(U,{value:"active",children:"Active"}),e.jsx(U,{value:"inactive",children:"Inactive"})]})]}),e.jsxs(G,{sx:{flexShrink:0,width:{xs:1,md:180}},children:[e.jsx(V,{children:"Role"}),e.jsx(Y,{multiple:!0,value:t.role,onChange:d,input:e.jsx(oe,{label:"Role"}),renderValue:n=>n.length===0?"All Roles":a.filter(r=>n.includes(r.value)).map(r=>r.label).join(", "),sx:{textTransform:"capitalize"},children:a.map(n=>e.jsxs(U,{value:n.value,children:[e.jsx(me,{disableRipple:!0,color:"default",size:"small",checked:t.role.includes(n.value)}),n.label]},n.value))})]}),e.jsx(z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:e.jsx(N,{fullWidth:!0,value:t.name,onChange:i,placeholder:"Search by name, username or email...",InputProps:{startAdornment:e.jsx(Fe,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]})}function Ys({filters:t,onFilters:s,onResetFilters:a,results:i,sx:d}){return e.jsxs(b,{sx:{...d,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("strong",{children:i}),e.jsx(b,{component:"span",sx:{color:"text.secondary"},children:"results found"})]}),e.jsx(P,{color:"error",onClick:a,startIcon:e.jsx(T,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})}function Xs({open:t,onClose:s,department:a,modules:i,selectedModules:d,onModuleToggle:u,onSave:n}){const r=p=>(p.displayName??p.module_name??p.name??"").replace(/[_-]/g," ").replace(/\s+/g," ").trim().split(" ").map(_=>_.charAt(0).toUpperCase()+_.slice(1).toLowerCase()).join(" "),x=p=>({Core:"primary",Analytics:"info",Monitoring:"warning",Maintenance:"secondary",Management:"success",Configuration:"default",Information:"default"})[p]||"default";return console.log("ModuleAssignmentDialog - modules:",i),console.log("ModuleAssignmentDialog - selectedModules:",d),e.jsxs(ue,{open:t,onClose:s,maxWidth:"md",fullWidth:!0,children:[e.jsx(he,{children:e.jsxs(b,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(F,{variant:"h6",children:["Manage Modules - ",a==null?void 0:a.department_name]}),e.jsx(ne,{onClick:s,size:"small",children:e.jsx(T,{icon:"mingcute:close-line"})})]})}),e.jsxs(xe,{children:[e.jsxs(b,{sx:{mb:2},children:[e.jsx(F,{variant:"subtitle1",gutterBottom:!0,children:"Assign modules to this department"}),e.jsx(F,{variant:"body2",color:"text.secondary",children:"Check the modules you want to assign to this department. Users in this department will have access to the selected modules."})]}),i.length===0?e.jsx(b,{sx:{textAlign:"center",py:4},children:e.jsx(F,{variant:"body2",color:"text.secondary",children:"No modules available. Please contact your administrator."})}):e.jsx(ps,{children:i.map(p=>e.jsxs(ms,{divider:!0,children:[e.jsx(gs,{children:e.jsx(me,{checked:d.includes(p.id),onChange:()=>u(p.id),color:"primary"})}),e.jsx(js,{primary:e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(F,{variant:"subtitle2",children:r(p)}),e.jsx(je,{label:p.module_type||"Module",size:"small",color:x(p.module_type),variant:"outlined"})]}),secondary:e.jsx(F,{variant:"body2",color:"text.secondary",children:p.description||`${p.module_type} module for ${r(p).toLowerCase()}`})})]},p.id))})]}),e.jsxs(pe,{children:[e.jsx(P,{onClick:s,children:"Cancel"}),e.jsxs(P,{onClick:n,variant:"contained",color:"primary",disabled:i.length===0,children:["Save (",d.length," selected)"]})]})]})}function Js({inputData:t,comparator:s,filters:a}){const{name:i,status:d}=a,u=t.map((n,r)=>[n,r]);return u.sort((n,r)=>{const x=s(n[0],r[0]);return x!==0?x:n[1]-r[1]}),t=u.map(n=>n[0]),i&&(t=t.filter(n=>n.department_name.toLowerCase().indexOf(i.toLowerCase())!==-1)),d!=="all"&&(t=t.filter(n=>n.status===d)),t}function Ks({filters:t,onFilters:s}){const a=l.useCallback(i=>{s("name",i.target.value)},[s]);return e.jsx(z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:e.jsx(z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:e.jsx(N,{fullWidth:!0,value:t.name,onChange:a,placeholder:"Search departments...",InputProps:{startAdornment:e.jsx(Fe,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})})}function Qs({filters:t,onFilters:s,onResetFilters:a,results:i,sx:d}){return e.jsxs(b,{sx:{...d,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("strong",{children:i}),e.jsx(b,{component:"span",sx:{color:"text.secondary"},children:"results found"})]}),e.jsx(P,{color:"error",onClick:a,startIcon:e.jsx(T,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})}const Zs=async()=>await O.get(B.notification.list),et=async t=>await O.post(B.notification.insert,t),st=async(t,s)=>await O.put(B.notification.update(t),s),tt=async t=>await O.delete(B.notification.delete(t)),Ve=[{id:"title",label:"Title",width:200},{id:"type",label:"Type",width:120},{id:"priority",label:"Priority",width:120},{id:"scheduled",label:"Scheduled",width:160},{id:"expires",label:"Expires",width:160},{id:"status",label:"Status",width:100},{id:"",width:120}],Xe=[{value:"INFO",label:"Info"},{value:"WARNING",label:"Warning"},{value:"ERROR",label:"Error"},{value:"SUCCESS",label:"Success"}],Je=[{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"CRITICAL",label:"Critical"}],De={title:"",status:"all",type:"all",priority:"all"};function at(){const t=ve(),s=fe(),a=se(),i=se(),{enqueueSnackbar:d}=Ee(),[u,n]=l.useState([]),[r,x]=l.useState([]),[p,S]=l.useState(De),[_,m]=l.useState(!1),[j,I]=l.useState(null),E=rt({inputData:u,comparator:Me(s.order,s.orderBy),filters:p}),$=E.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage),A=s.dense?52:72,w=!be(De,p),X=!E.length&&w||!E.length,R=l.useCallback(async()=>{try{m(!0);const h=await Zs();if(h.status&&h.response){const v=h.response.map(W=>({...W,status:W.status===1?"active":"inactive"}));n(v)}}catch(h){console.error("Error loading notifications:",h),n([])}finally{m(!1)}},[]),M=l.useCallback(async()=>{try{const h=await Ye();if(h.status&&h.response){const v=h.response.map(W=>({...W,name:`${W.first_name} ${W.last_name}`}));x(v)}}catch(h){console.error("Error loading users:",h),x([])}},[]);l.useEffect(()=>{R(),M()},[R,M]);const L=l.useCallback((h,v)=>{s.onResetPage(),S(W=>({...W,[h]:v}))},[s]),J=l.useCallback(async h=>{try{await tt(h),await R(),s.onUpdatePageDeleteRow($.length),d("Notification deleted successfully",{variant:"success"})}catch(v){console.error("Error deleting notification:",v),d("Failed to delete notification",{variant:"error"})}},[$.length,s,R]),Q=l.useCallback(h=>{I(h),i.onTrue()},[i]),re=l.useCallback(async h=>{try{const v={title:h.title,message:h.message,notification_type:h.type,priority:h.priority,scheduled_at:h.scheduledAt?h.scheduledAt.toISOString():null,expires_at:h.expiresAt?h.expiresAt.toISOString():null,status:h.status==="active"?1:0,user_ids:h.userIds||[]};j?(await st(j.id,v),d("Notification updated successfully",{variant:"success"})):(await et(v),d("Notification created successfully",{variant:"success"})),await R(),i.onFalse(),I(null)}catch(v){console.error("Error saving notification:",v),d("Failed to save notification",{variant:"error"})}},[j,R,i]),H=l.useCallback(()=>{I(null),i.onTrue()},[i]);window.openNewNotificationDialog=H;const K=l.useCallback(()=>{S(De)},[]),o=h=>({INFO:"info",WARNING:"warning",ERROR:"error",SUCCESS:"success"})[h]||"default",C=h=>({LOW:"success",MEDIUM:"warning",HIGH:"error",CRITICAL:"error"})[h]||"default",D=h=>h?bs(new Date(h),"PPp"):"Not set",k=h=>u.filter(v=>v.status===h).length,Z=[{value:"all",label:"All",color:"default",count:u.length},{value:"active",label:"Active",color:"success",count:k("active")},{value:"inactive",label:"Inactive",color:"default",count:k("inactive")}];return e.jsx(vs,{dateAdapter:fs,children:e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:[e.jsx(ce,{value:p.status,onChange:(h,v)=>L("status",v),sx:{px:2.5,boxShadow:`inset 0 -2px 0 0 ${te(t.palette.grey[500],.08)}`,backgroundColor:t.palette.primary.main},children:Z.map(h=>e.jsx(de,{value:h.value,label:h.label,iconPosition:"end",icon:e.jsx(ae,{variant:(h.value==="all"||h.value===p.status)&&"filled"||"soft",color:h.color,children:h.count}),sx:{color:p.status===h.value?t.palette.primary.contrastText:"white","&.Mui-selected":{color:t.palette.primary.contrastText},"&:hover":{backgroundColor:te(t.palette.grey[500],.1)}}},h.value))}),e.jsx(it,{filters:p,onFilters:L,typeOptions:Xe,priorityOptions:Je}),w&&e.jsx(ot,{filters:p,onFilters:L,onResetFilters:K,results:E.length,sx:{p:2.5,pt:0}})]}),e.jsxs(q,{children:[e.jsx(ye,{sx:{position:"relative",overflow:"unset"},children:e.jsx(Ce,{children:e.jsxs(we,{size:s.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(Se,{order:s.order,orderBy:s.orderBy,headLabel:Ve,rowCount:u.length,onSort:s.onSort}),e.jsxs(Pe,{children:[_&&e.jsx(le,{children:e.jsx(f,{colSpan:Ve.length,align:"center",sx:{py:3},children:"Loading notifications..."})}),!_&&E.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(h=>e.jsx(nt,{row:h,onDeleteRow:()=>J(h.id),onEditRow:()=>Q(h),getNotificationTypeColor:o,getPriorityColor:C,formatDate:D},h.id)),e.jsx(Te,{height:A,emptyRows:ke(s.page,s.rowsPerPage,u.length)}),e.jsx(Ie,{notFound:X})]})]})})}),e.jsx(Ne,{count:E.length,page:s.page,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage,dense:s.dense,onChangeDense:s.onChangeDense})]}),e.jsx(lt,{open:i.value,onClose:i.onFalse,notification:j,users:r,onSave:re}),e.jsx(Le,{open:a.value,onClose:a.onFalse,title:"Delete",content:"Are you sure you want to delete the selected notification?",action:e.jsx(P,{variant:"contained",color:"error",onClick:()=>{a.onFalse()},children:"Delete"})})]})})}function nt({row:t,onDeleteRow:s,onEditRow:a,getNotificationTypeColor:i,getPriorityColor:d,formatDate:u}){return e.jsxs(le,{hover:!0,children:[e.jsx(f,{children:e.jsxs(b,{children:[e.jsx(F,{variant:"subtitle2",children:t.title}),e.jsx(F,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.message})]})}),e.jsx(f,{children:e.jsx(je,{label:t.notification_type,size:"small",color:i(t.notification_type)})}),e.jsx(f,{children:e.jsx(je,{label:t.priority,size:"small",color:d(t.priority),variant:"outlined"})}),e.jsx(f,{children:e.jsx(F,{variant:"body2",children:u(t.scheduled_at)})}),e.jsx(f,{children:e.jsx(F,{variant:"body2",children:u(t.expires_at)})}),e.jsx(f,{children:e.jsx(ae,{variant:"soft",color:t.status==="active"&&"success"||"default",children:t.status})}),e.jsx(f,{align:"right",children:e.jsxs(b,{sx:{display:"flex",gap:.5,justifyContent:"flex-end"},children:[e.jsx(ne,{onClick:a,size:"small",children:e.jsx(T,{icon:"solar:pen-bold"})}),e.jsx(ne,{onClick:s,size:"small",sx:{color:"error.main"},children:e.jsx(T,{icon:"solar:trash-bin-trash-bold"})})]})})]})}function lt({open:t,onClose:s,notification:a,users:i,onSave:d}){const[u,n]=l.useState({title:"",message:"",type:"INFO",priority:"MEDIUM",scheduledAt:null,expiresAt:null,status:"active",userIds:[]});l.useEffect(()=>{n(a?{title:a.title||"",message:a.message||"",type:a.notification_type||"INFO",priority:a.priority||"MEDIUM",scheduledAt:a.scheduled_at?new Date(a.scheduled_at):null,expiresAt:a.expires_at?new Date(a.expires_at):null,status:a.status||"active",userIds:[]}:{title:"",message:"",type:"INFO",priority:"MEDIUM",scheduledAt:null,expiresAt:null,status:"active",userIds:[]})},[a]);const r=m=>j=>{n(I=>({...I,[m]:j.target.value}))},x=m=>j=>{n(I=>({...I,[m]:j}))},p=m=>{n(j=>({...j,userIds:j.userIds.includes(m)?j.userIds.filter(I=>I!==m):[...j.userIds,m]}))},S=()=>{d(u)},_=m=>m.first_name&&m.last_name?`${m.first_name} ${m.last_name}`:m.user_name;return e.jsxs(ue,{open:t,onClose:s,maxWidth:"md",fullWidth:!0,children:[e.jsx(he,{children:a?"Edit Notification":"New Notification"}),e.jsx(xe,{children:e.jsxs(b,{sx:{display:"flex",flexDirection:"column",gap:2,pt:1},children:[e.jsx(N,{label:"Title",value:u.title,onChange:r("title"),fullWidth:!0,required:!0}),e.jsx(N,{label:"Message",value:u.message,onChange:r("message"),fullWidth:!0,multiline:!0,rows:4,required:!0}),e.jsxs(z,{direction:"row",spacing:2,children:[e.jsxs(G,{fullWidth:!0,children:[e.jsx(V,{children:"Type"}),e.jsx(Y,{value:u.type,onChange:r("type"),label:"Type",children:Xe.map(m=>e.jsx(U,{value:m.value,children:m.label},m.value))})]}),e.jsxs(G,{fullWidth:!0,children:[e.jsx(V,{children:"Priority"}),e.jsx(Y,{value:u.priority,onChange:r("priority"),label:"Priority",children:Je.map(m=>e.jsx(U,{value:m.value,children:m.label},m.value))})]}),e.jsxs(G,{fullWidth:!0,children:[e.jsx(V,{children:"Status"}),e.jsxs(Y,{value:u.status,onChange:r("status"),label:"Status",children:[e.jsx(U,{value:"active",children:"Active"}),e.jsx(U,{value:"inactive",children:"Inactive"})]})]})]}),e.jsxs(z,{direction:"row",spacing:2,children:[e.jsx(He,{label:"Scheduled At",value:u.scheduledAt,onChange:x("scheduledAt"),renderInput:m=>e.jsx(N,{...m})}),e.jsx(He,{label:"Expires At",value:u.expiresAt,onChange:x("expiresAt"),renderInput:m=>e.jsx(N,{...m})})]}),e.jsxs(b,{children:[e.jsx(F,{variant:"subtitle1",gutterBottom:!0,children:"Target Users (optional)"}),e.jsx(F,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select users to receive this notification. If no users are selected, it will be a general notification."}),e.jsx(b,{sx:{maxHeight:200,overflow:"auto"},children:e.jsx(z,{spacing:1,children:i.map(m=>e.jsx(q,{variant:"outlined",sx:{cursor:"pointer"},children:e.jsx(Is,{sx:{py:1},children:e.jsx(ys,{control:e.jsx(me,{checked:u.userIds.includes(m.id),onChange:()=>p(m.id),color:"primary"}),label:e.jsxs(b,{children:[e.jsx(F,{variant:"subtitle2",children:_(m)}),e.jsx(F,{variant:"body2",color:"text.secondary",children:m.email})]})})})},m.id))})})]})]})}),e.jsxs(pe,{children:[e.jsx(P,{onClick:s,children:"Cancel"}),e.jsx(P,{onClick:S,variant:"contained",color:"primary",children:"Save"})]})]})}function rt({inputData:t,comparator:s,filters:a}){const{title:i,status:d,type:u,priority:n}=a,r=t.map((x,p)=>[x,p]);return r.sort((x,p)=>{const S=s(x[0],p[0]);return S!==0?S:x[1]-p[1]}),t=r.map(x=>x[0]),i&&(t=t.filter(x=>x.title.toLowerCase().indexOf(i.toLowerCase())!==-1)),d!=="all"&&(t=t.filter(x=>x.status===d)),u!=="all"&&(t=t.filter(x=>x.notification_type===u)),n!=="all"&&(t=t.filter(x=>x.priority===n)),t}function it({filters:t,onFilters:s,typeOptions:a,priorityOptions:i}){const d=l.useCallback(r=>{s("title",r.target.value)},[s]),u=l.useCallback(r=>{s("type",r.target.value)},[s]),n=l.useCallback(r=>{s("priority",r.target.value)},[s]);return e.jsxs(z,{spacing:2,alignItems:{xs:"flex-end",md:"center"},direction:{xs:"column",md:"row"},sx:{p:2.5,pr:{xs:2.5,md:1}},children:[e.jsxs(G,{sx:{flexShrink:0,width:{xs:1,md:140}},children:[e.jsx(V,{children:"Type"}),e.jsxs(Y,{value:t.type,onChange:u,input:e.jsx(oe,{label:"Type"}),sx:{textTransform:"capitalize"},children:[e.jsx(U,{value:"all",children:"All Types"}),a.map(r=>e.jsx(U,{value:r.value,children:r.label},r.value))]})]}),e.jsxs(G,{sx:{flexShrink:0,width:{xs:1,md:140}},children:[e.jsx(V,{children:"Priority"}),e.jsxs(Y,{value:t.priority,onChange:n,input:e.jsx(oe,{label:"Priority"}),sx:{textTransform:"capitalize"},children:[e.jsx(U,{value:"all",children:"All Priorities"}),i.map(r=>e.jsx(U,{value:r.value,children:r.label},r.value))]})]}),e.jsx(z,{direction:"row",alignItems:"center",spacing:2,flexGrow:1,sx:{width:1},children:e.jsx(N,{fullWidth:!0,value:t.title,onChange:d,placeholder:"Search notifications...",InputProps:{startAdornment:e.jsx(Fe,{position:"start",children:e.jsx(T,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})})]})}function ot({filters:t,onFilters:s,onResetFilters:a,results:i,sx:d}){return e.jsxs(b,{sx:{...d,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(b,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx("strong",{children:i}),e.jsx(b,{component:"span",sx:{color:"text.secondary"},children:"results found"})]}),e.jsx(P,{color:"error",onClick:a,startIcon:e.jsx(T,{icon:"solar:trash-bin-trash-bold"}),children:"Clear"})]})}function Re({children:t,value:s,index:a,...i}){return e.jsx("div",{role:"tabpanel",hidden:s!==a,id:`simple-tabpanel-${a}`,"aria-labelledby":`simple-tab-${a}`,...i,children:s===a&&t})}const ct=[{value:0,label:"User List"},{value:1,label:"Departments"},{value:2,label:"Notifications"}];function dt(){const t=Cs(),[s,a]=l.useState(0),i=l.useCallback((r,x)=>{a(x)},[]),d=l.useCallback(()=>{window.openNewUserDialog&&window.openNewUserDialog()},[]),u=l.useCallback(()=>{window.openNewDepartmentDialog&&window.openNewDepartmentDialog()},[]),n=l.useCallback(()=>{window.openNewNotificationDialog&&window.openNewNotificationDialog()},[]);return e.jsxs(ws,{maxWidth:t.themeStretch?!1:"xl",children:[e.jsxs(Ue,{container:!0,spacing:2,sx:{alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsx(Ue,{item:!0,children:e.jsx(ce,{value:s,onChange:i,children:ct.map(r=>e.jsx(de,{label:r.label,value:r.value},r.value))})}),e.jsxs(Ue,{item:!0,children:[s===0&&e.jsx(P,{onClick:d,variant:"contained",color:"primary",startIcon:e.jsx(T,{icon:"mingcute:add-line"}),children:"New User"}),s===1&&e.jsx(P,{onClick:u,variant:"contained",color:"primary",startIcon:e.jsx(T,{icon:"mingcute:add-line"}),children:"New Department"}),s===2&&e.jsx(P,{onClick:n,variant:"contained",color:"primary",startIcon:e.jsx(T,{icon:"mingcute:add-line"}),children:"New Notification"})]})]}),e.jsx(Re,{value:s,index:0,children:e.jsx(q,{children:e.jsx(_s,{})})}),e.jsx(Re,{value:s,index:1,children:e.jsx(q,{children:e.jsx($s,{})})}),e.jsx(Re,{value:s,index:2,children:e.jsx(q,{children:e.jsx(at,{})})})]})}function mt(){return e.jsxs(e.Fragment,{children:[e.jsx(Ss,{children:e.jsx("title",{children:" User Management"})}),e.jsx(dt,{})]})}export{mt as default};
